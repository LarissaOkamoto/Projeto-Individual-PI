<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="Login.css">
        <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Elms+Sans:ital,wght@0,100..900;1,100..900&family=Playfair+Display:ital,wght@0,400..900;1,400..900&display=swap" rel="stylesheet">
    <script src="public/js/sessao.js"></script>
</head>
<body>
    <div class="header"></div>
    <div class="container">
        <ul class="navbar">
            <div class="navbar_esquerda">
            <li>
                <a href="Index.html" class="HomePage">Início</a>
            </li>
            <li>
                <a href="SobreNos.html" class="SobreNos">Sobre</a>
            </li>
            <li>
                <a href="MonteOSeu.html" class="Monte o seu">Monte o seu</a>
            </li>
            </div>
            <div class="navbar_central">
            <img src="Imagens/img-logo3.png" class="img-logo3">
            </div>
            <div class="navbar_direita">
            <li>
                <a href="Duvidas.html" class="Duvidas">Dúvidas</a>
            </li>
            <li>
                <a href="Contato.html" class="Contato">Contato</a>
            </li>
            <li>
                <div class="button_login" onclick="window.location.href='Login.html';">
                <img src="Imagens/img-login.png" class="img-login">
                <a href="Login.html" class="Login">Login</a>
                </div>
            </li>
            </div>
        </ul>
    </div>

    <div class="box">
        <img src="Imagens/img-albumLogin.png" class="img-albumLogin">
        <div class="login_body">  
        <div class="login">
            <h2>Login</h2>
            <input type="text" id="input_email" class="input" placeholder="Digite o seu e-mail">
            <br/><br/>
            <input type="password" id="input_senha" class="input" placeholder="Digite a sua senha">
            <br/><br/>
            <button onclick="entrar()" class="button_entrar">Entrar</button>
            <br/><br/>
        </div>
        <div class="senha_cadastro">
            <li>
            <a href="Cadastro.html" class="cadastro">Quero me cadastrar!</a>
            <br/><br/>
            </li>
            <li>
            <a href="NovaSenha.html" class="nova_senha">Esqueci minha senha</a>
            </li>
        </div>
        </div>
        <div class="alerta_erro">
            <div class="card_erro" id="cardErro">
                <span id="mensagem_erro"></span>
            </div>
        </div>
    </div>




    <hr class="divider">
    <div class="footer">
        <div class="footer_body">
        <div class="contatos">
            <h2>Fale Conosco</h2>
            <img src="" class="img-telefone">
            <p><b>Telefone:</b> +55 11 3000-0000</p>
            <img src="" class="img-email">
            <p><b>E-mail:</b> umui@outlook.com</p>
            <img src="" class="img-instagram">
            <p><b>Instagram:</b> @Umui.Project</p>
        </div>

        <div class="ajuda">
            <h2>Ajuda</h2>
            <p>FAQ</p>
            <p>Garantias</p>
        </div>
    
        <div class="dados_empresa">
            <h2>Umui Project .Ltda</h2>
            <p>Somos uma marca autoral que eternaliza pessoas, memórias e histórias com muito carinho e amor, por meio de um registro físico.
            <br/>
            <p><b>CNPJ:</b> 11.111.111/0001-11</p>
            <p>Rua Haddock Lobo, 595 - Cerqueira César, São Paulo - SP, 01414-001</p>
        </div>
        </div>
        <hr class="divider">
        <div class="footer_botton">
        <div class="politicas">
            <div class="button_politicas">
            <p>Política de Privacidade</p>
            <p>Termos & Condições</p>
            <p>Segurança</p>
            </div>
            <div class="texto_politicas">
            <p>Copyright © 2025 Umui, Inc. All rights reserved.</p>
            </div>
        </div>
        </div>
    </div>
</body>
</html>

<script>

    function entrar() {
        //aguardar();

        var emailVar = input_email.value;
        var senhaVar = input_senha.value;

        if (emailVar == "" || senhaVar == "") {
            alert(`Preencha todos os campos do login`)
            /*cardErro.style.display = "block"
            mensagem_erro.innerHTML = "(Mensagem de erro para todos os campos em branco)";
            */
            //finalizarAguardar();
            return false;
        }
        else {
            // setInterval(sumirMensagem, 5000)
        }

        console.log("FORM LOGIN: ", emailVar);
        console.log("FORM SENHA: ", senhaVar);

        fetch("/usuarios/autenticar", {
            method: "POST",
            headers: {
                "Content-Type": "application/json"
            },
            body: JSON.stringify({
                emailServer: emailVar,
                senhaServer: senhaVar
            })
        }).then(function (resposta) {
            console.log("ESTOU NO THEN DO entrar()!")

            if (resposta.ok) {
                console.log(resposta);

                resposta.json().then(json => {
                    console.log(json);
                    console.log(JSON.stringify(json));
                    sessionStorage.EMAIL_USUARIO = json.email;
                    sessionStorage.NOME_USUARIO = json.nome;
                    sessionStorage.ID_USUARIO = json.id;

                    setTimeout(function () {
                        window.location = "./Dashboard.html";
                    }, 500); // apenas para exibir o loading

                });

            } else {

                console.log("Houve um erro ao tentar realizar o login!");

                resposta.text().then(texto => {
                    console.error(texto);
                    //finalizarAguardar(texto);
                });
            }

        }).catch(function (erro) {
            console.log(erro);
        })

        return false;
    }

    // function sumirMensagem() {
    //     cardErro.style.display = "none"
    // }
    
</script>